import React, { useState } from 'react';
import { Button, TextField } from '@mui/material';

// ğŸ™‹â€â™€ï¸ğŸ¤”
// â‘ textã®stateâ‘¡todoé…åˆ—ã®stateã‚’ä½œæˆ

function List() {
  const [inputText, setInputText] = useState('');
  const [todos, setTodos] = useState<Todo[]>([]);

  type Todo = {
    id: number;
    inputValue: string;
    checked: boolean;
  };

  const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {
    // ğŸŒ¸ğŸ¤¬formã˜ã‚ƒãªã„ã‹ã‚‰ã„ã‚‰ãªã„
    // e.preventDefault();
    setInputText(e.target.value);
  };

  // ğŸŒ¸ğŸ¤¬The e parameter in the handleSubmit function should be of type React.FormEvent<HTMLFormElement> instead of React.ChangeEvent<HTMLInputElement>. This is because handleSubmit is handling a form submission event, not an input change event.
  const handleSubmit = (e: React.FormEvent<HTMLFormElement>) => {
    e.preventDefault();

    // ğŸŒ¸ğŸ¤¬handleSubmitã®ä¸­ã˜ã‚ƒãªã„ã¨æ¯å›ä½œã‚‰ã‚Œãªã„
    // ğŸŒ¸ğŸ¤¬objectã ã‹ã‚‰;ã˜ã‚ƒãªã,
    const newTask: Todo = {
      // ğŸŒ¸ğŸ¤¬For the id of newTask, since you don't have a separate state or variable to hold the next ID value, you could use the current length of the todos array as a simple way to generate unique IDs. Note that this approach only works as long as you never remove tasks from the middle of the list.
      // id: id,
      // ğŸ™‹â€â™€ï¸ğŸ¤”why todos.length,?
      // ğŸŒ¸ğŸ‘©â€ğŸ“ Using the length of the todos array to generate the id is a simple way to ensure uniqueness when you're only adding items to the end of the list.
      // In a real-world application, you might use something like a UUID (Universally Unique Identifier) or an ID generated by a backend database to ensure uniqueness. For this simple example, using the array length as the id is an easy solution that doesn't require any extra libraries or backend setup.
      id: todos.length,
      inputValue: inputText,
      checked: false,
    };

    // ğŸŒ¸ğŸ¤¬In the handleSubmit function, you're trying to add inputText directly to the todos array. But each todo should be an object with properties id, inputValue, and checked. So, you should create a new Todo object with these properties and add that to the todos array.
    // setTodos([inputText, ...todos]);
    // ğŸŒ¸ğŸ¤¬In setTodos([newTask.inputValue, ...todos]), you should be adding newTask, not newTask.inputValue, to the todos array.
    // setTodos([newTask.inputValue, ...todos]);
    setTodos([newTask, ...todos]);

    console.log(todos);
  };

  const handleEdit = (id: number, inputValue: string) => {
    console.log(id, inputValue);
    // ğŸŒ¸ğŸ‘©â€ğŸ“ handleEdit: When the text input of a todo item is changed, this function is called with the id of the todo and the new input value. Inside this function, you should create a new array of todos where the todo with the given id has its inputValue replaced with the new input value. Then, call setTodos with this new array.
    const newTodos = todos.map((todo) => {
      if (todo.id === id) {
        //      â†“ğŸ‘©â€ğŸ“ğŸ‘©â€ğŸ“ä»Šæ‰“ã£ã¦ã‚‹value
        todo.inputValue = inputValue;
      }
      return todo;
    });
    setTodos(newTodos);
  };

  // 28:30~
  const handleChecked = (id: number, checked: boolean) => {
    console.log(id, checked);

    const newTodos = todos.map((todo) => {
      if (todo.id === id) {
        //  â†“ğŸ‘©â€ğŸ“ğŸ‘©â€ğŸ“ä»Šæ‰“ã£ã¦ã‚‹valueã‚’å‰ã®inputValueã«å…¥ã‚Œã‚‹  31:20ğŸ‘©â€ğŸ“ğŸ¤¬ã€Œï¼ã€å…¥ã‚Œã‚‹ï¼ï¼ï¼
        todo.checked = !checked;
      }
      return todo;
    });
    setTodos(newTodos);
  };

  const handleDelete = (id: number) => {
    console.log(id);
    const newTodos = todos.filter((todo) => todo.id !== id);
    setTodos(newTodos);
  };

  return (
    <div className='list'>
      <form action="" className="form" onSubmit={(e) => handleSubmit(e)}>
        <TextField
          id="filled-basic"
          label="In this session, I'll do..."
          variant="filled"
          type="text"
          onChange={(e) => handleChange(e)}
          className="inputText"
        />
<Button variant="contained"   type="submit" value="create" className="submitButton" >Create</Button>
      </form>
      {/* ã‚¿ã‚¹ã‚¯è¨­å®šãŒå®Œäº†ã—ãŸã‚‰ */}
      {/*ã“ã“ã‹ã‚‰ğŸ™‹â€â™€ï¸ğŸ™‹â€â™€ï¸ğŸ™‹â€â™€ï¸ğŸ™‹â€â™€ï¸ğŸ™‹â€â™€ï¸ğŸ™‹â€â™€ï¸ğŸ™‹â€â™€ï¸ğŸ™‹â€â™€ï¸  */}
      {/* ğŸŒ¸ğŸ¤¬ */}
      <ul className="todoList">
        {/* ğŸŒ¸ğŸ¤¬(todo) => ã®ã‚ã¨ã¯ã‹ã£ã“ï¼ï¼ */}
        {todos.map((todo) => (
          <li key={todo.id} className='todo'>
            <TextField
              id="standard-basic"
              label=""
              variant="standard"
              type="text"
              value={todo.inputValue}
              // ğŸŒ¸ğŸ¤¬ç¬¬ä¸€å¼•æ•°ã¯todo.id
              onChange={(e) => handleEdit(todo.id, e.target.value)}
              className="inputText"
              disabled={todo.checked}
            />
            <input
              type="checkbox"
              checked={todo.checked}
              // ğŸŒ¸ğŸ¤¬
              onChange={() => handleChecked(todo.id, todo.checked)}
            />
            <Button variant="outlined"  onClick={() => handleDelete(todo.id)}>Delete</Button>
          </li>
        ))}
      </ul>
    </div>
  );
}
export default List;
